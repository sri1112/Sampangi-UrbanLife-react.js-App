"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[47442],{792862:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var a=n(667294),i=n(545007),o=n(883119),r=n(985459),l=n(547504),s=n(95460),c=n(909512),d=n(233846),u=n(298568);function p({constraint:e}){let t=(0,u.E)(),n=t?.getId();return(0,a.useEffect)(()=>{t&&t.markConstraintComplete(e)},[n,e]),null}var _=n(349057),m=n(181710),v=n(943369),h=n(677316),f=n(755090),b=n(604342),k=n(356204),g=n(739951),S=n(506536),x=n(757653),A=n(785893);let I=(0,x.Z)(()=>n.e(43473).then(n.bind(n,16736)),void 0,e=>16736,"PinSaveButtonCommon"),C=(0,a.lazy)(async()=>({default:(await Promise.all([n.e(69965),n.e(22538)]).then(n.bind(n,797043))).QuickSaveButtonWithExperienceAnchor})),w=({boardCount:e=0,clientTrackingParams:t,fromEggsBoard:n,onBoardSelectionFlyoutChange:x,onClickCallback:w,pin:P,showEnabledSaveBehavior:y,showRepinOnInitialRender:Z,variant:E,viewParameter:j,viewType:D})=>{let T=(0,u.E)(),{experience:B}=(0,c.Ow)(1000310),{experience:M}=(0,c.Ow)(12),O=(0,h.Z)(),Q=(0,i.I0)(),K=(0,d.ZP)(),L=(0,a.useRef)(!1),{pins:N,clear:R}=(0,k.Z)(),U=(0,v.M0)().getItem(l.M8)||"",H=U?U===P.id:!!N&&N.length>0&&N[N.length-1].id===P.id;(0,f.Z)(()=>{L.current||2!==N.length&&(1!==N.length||H)||(L.current=!0,(2===N.length&&!U&&H?[N[0]]:N).forEach(({id:e,nodeId:t})=>{(0,r.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},K).then(n=>{let{id:a,url:i,name:o}=n;Q((0,g.d)({boardId:a,url:i,title:o||"",pinId:e||"",nodeId:t}))})}),H||R())});let q=()=>{(0,v.M0)().removeItem(l.M8),R(),O({action:"trigger",item:"unauth-save-button-quicksave"}),Q((0,S.Z)(!0)),Q((0,g.d)({boardId:"",url:"",title:"Profile",pinId:P.id,nodeId:P?.node_id})),Q((0,g.X)(P))},F=()=>{(0,_.Nx)("button"),T&&T.markConstraintComplete("button")};if(P?.pinner?.blocked_by_me||P?.promoted_is_removable)return(0,_.Nx)("button"),(0,A.jsx)(p,{constraint:"button"});if(B&&502450===B.experience_id)return(0,A.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,A.jsx)(m.Z,{children:(0,A.jsx)(C,{autoQuicksaveCallback:q,clientTrackingParams:t,experience:B,onClickCallback:w,onMount:F,pinKey:{type:"deprecated",data:P},shouldAutoQuicksave:H,showEnabledSaveBehavior:y,viewParameter:j})})});let W=!P.content_sensitivity?.is_sensitive_content&&void 0!==e,z=[501041],V=M&&501041===M.experience_id&&M.display_data.has_tooltip?e=>(0,A.jsx)(c.Qp,{anchor:e,experienceIds:z,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):e=>(0,A.jsx)(c.N,{anchors:{3010:e},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0});return W?(0,A.jsx)(o.xu,{children:(0,A.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,A.jsx)(b.default,{autoQuicksaveCallback:q,clientTrackingParams:t,fromEggsBoard:n,onClickCallback:w,onMount:F,onToggleFlyout:x,pinKey:{type:"deprecated",data:P},renderPinSaveTooltip:V,shouldAutoQuicksave:H,variant:E,viewParameter:j,viewType:D})})}):(0,A.jsx)(s.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,A.jsx)(m.Z,{children:(0,A.jsx)(I,{clientTrackingParams:t,isCloseupPin:!0,onClickCallback:w,onMount:F,pinKey:{type:"deprecated",data:P},renderPinSaveTooltip:V,showRepinOnInitialRender:Z})})})}},356204:(e,t,n)=>{n.d(t,{$:()=>s,Z:()=>u});var a=n(547504),i=n(838380),o=n(967312),r=n(943369),l=n(756493);let s=2,c=e=>e?.pins??[],d=e=>e.length?{pins:e}:null,u=()=>{let e=(0,r.M0)(),t=c(e.accessAllowed?e.getItem(a.s1):l.ZP.getItem(i.w3)),n=t=>e.accessAllowed?e.setItem(a.s1,d(t)):l.ZP.setItem(i.w3,d(t)),u=s,{checkExperiment:p}=(0,o.F)(),_=()=>{let e=p("mweb_block_unauth_save").group;if(e.startsWith("enabled")){let[,t]=e.split("_");u=Number(t)}let n=p("mweb_q2_mau_push_pc").group;return"enabled"===n&&(u=0),"control"===n&&(u=s),t.length<u};return{pins:t,save:e=>{_()&&n(t.filter(({id:t})=>t!==e.id).concat([e]))},unsave:e=>n(t.filter(({id:t})=>t!==e)),isSaved:e=>t.some(({id:t})=>t===e),clear:()=>n([]),canSaveMore:_}}},506536:(e,t,n)=>{n.d(t,{Z:()=>a});function a(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/SaveAffordance-9e011562db29b9eb.mjs.map